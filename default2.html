<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>
<script src="kinetic-v4.3.2.min.js"></script>
<style>
      body {
        margin: 0px;
        padding: 0px;
      }
    </style>
</head>

<body>
    <div id="container"></div>
    <script>
  // http://kineticjs.com/docs/symbols/Kinetic.Node.php#off
	// https://github.com/ericdrowell/KineticJS/wiki
	  var startX = 0;
	  var startY = 0;
	  var endX = 0;
	  var endY = 0;
	  var drawing = false;
	  
      var stage = new Kinetic.Stage({
        container: 'container',
        width: 1024,
        height: 768
      });

      var layer = new Kinetic.Layer();
	  var messageLayer = new Kinetic.Layer();
	  var rect = new Kinetic.Rect({
        x: 0,
        y: 0,
        width: 1024,
        height: 768,
        fill: 'gray',
        stroke: 'black',
        strokeWidth: 2
      });
	  
	  function writeMessage(messageLayer, message) {
        var context = messageLayer.getContext();
        messageLayer.clear();
        context.font = '18pt Calibri';
        context.fillStyle = 'black';
        context.fillText(message, 10, 25);
      }

      // add the shape to the layer
      layer.add(rect);
	  
      var redLine = new Kinetic.Line({
        points: [startX, startY, endX, endY],
        stroke: 'black',
        strokeWidth: 15,
        lineCap: 'round',
        lineJoin: 'round'
      });

	  layer.add(redLine);
      /*
       * since each line has the same point array, we can
       * adjust the position of each one using the
       * move() method
       */
      //redLine.move(0, 5);

      
	  //myShape.remove();
	  //myLayer.draw();
      stage.add(layer);
	  stage.add(messageLayer);
	  stage.on('mousemove', function(pos) {
		if(drawing) {
			endX = pos.x;
			endY = pos.y;
			redLine.setPoints([startX, startY, endX, endY]);
			layer.draw();
		}
      });
	  stage.on('mousedown', function(pos) {
		drawing = true;
		startX = pos.x;
		startY = pos.y;
		writeMessage(messageLayer, 'mousedown' + pos.x + " , " + pos.y);
		redLine.setPoints([startX, startY, startX, startY]);
		redLine.show();
		layer.draw();
      });
      stage.on('mouseup', function() {
		drawing = false;
		redLine.hide();
		layer.draw();
		writeMessage(messageLayer, 'mouseup');
      });
    </script>


</body>
</html>
